{% extends "base.html" %}

{% block title %}Tambah Data PDSPKP - PDSPKP System{% endblock %}

{% block content %}
<div class="row">
    <div class="col-12">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h2><i class="fas fa-plus-circle"></i> Tambah Data PDSPKP</h2>
            <a href="{{ url_for('dashboard') }}" class="btn btn-secondary">
                <i class="fas fa-arrow-left"></i> Kembali ke Dashboard
            </a>
        </div>

        <div class="card">
            <div class="card-header card-header-custom">
                <h5 class="mb-0"><i class="fas fa-edit"></i> Form Input Data PDSPKP</h5>
            </div>
            <div class="card-body">
                <form method="POST">
                    <div class="row">
                        <!-- Informasi Perusahaan -->
                        <div class="col-md-6">
                            <h6 class="text-primary mb-3"><i class="fas fa-building"></i> Informasi Perusahaan</h6>
                            
                            <div class="mb-3">
                                <label for="nama_perusahaan" class="form-label">Nama Perusahaan *</label>
                                <input type="text" class="form-control" id="nama_perusahaan" name="nama_perusahaan" required>
                            </div>

                            <div class="mb-3">
                                <label for="alamat" class="form-label">Alamat *</label>
                                <textarea class="form-control" id="alamat" name="alamat" rows="3" required></textarea>
                            </div>

                            <div class="mb-3">
                                <label for="jenis_produk" class="form-label">Jenis Produk *</label>
                                <select class="form-control" id="jenis_produk" name="jenis_produk" required>
                                    <option value="">-- Pilih Kategori --</option>
                                    <optgroup label="Budidaya">
                                        <option value="Budidaya - Ikan Air Tawar">Budidaya - Ikan Air Tawar</option>
                                        <option value="Budidaya - Ikan Air Laut">Budidaya - Ikan Air Laut</option>
                                        <option value="Budidaya - Udang">Budidaya - Udang</option>
                                        <option value="Budidaya - Rumput Laut">Budidaya - Rumput Laut</option>
                                        <option value="Budidaya - Kerang">Budidaya - Kerang</option>
                                    </optgroup>
                                    <optgroup label="Tangkap">
                                        <option value="Tangkap - Ikan Laut">Tangkap - Ikan Laut</option>
                                        <option value="Tangkap - Ikan Air Tawar">Tangkap - Ikan Air Tawar</option>
                                        <option value="Tangkap - Udang Laut">Tangkap - Udang Laut</option>
                                        <option value="Tangkap - Cumi-cumi">Tangkap - Cumi-cumi</option>
                                        <option value="Tangkap - Kepiting">Tangkap - Kepiting</option>
                                    </optgroup>
                                </select>
                                <small class="form-text text-muted">Atau ketik jenis produk lainnya</small>
                            </div>

                            <div class="mb-3">
                                <input type="text" class="form-control" id="jenis_produk_custom" name="jenis_produk_custom" placeholder="Atau tulis jenis produk lainnya...">
                            </div>

                            <div class="mb-3">
                                <label for="contact_person" class="form-label">Contact Person *</label>
                                <input type="text" class="form-control" id="contact_person" name="contact_person" required>
                            </div>

                            <div class="mb-3">
                                <label for="email" class="form-label">Email *</label>
                                <input type="email" class="form-control" id="email" name="email" required>
                            </div>
                        </div>

                        <!-- Informasi Permohonan -->
                        <div class="col-md-6">
                            <h6 class="text-primary mb-3"><i class="fas fa-file-alt"></i> Informasi Permohonan</h6>
                            
                            <div class="mb-3">
                                <label for="nomor_permohonan" class="form-label">Nomor Permohonan *</label>
                                <input type="text" class="form-control" id="nomor_permohonan" name="nomor_permohonan" required>
                            </div>

                            <div class="mb-3">
                                <label for="tanggal_permohonan" class="form-label">Tanggal Permohonan *</label>
                                <input type="date" class="form-control" id="tanggal_permohonan" name="tanggal_permohonan" required>
                            </div>

                            <div class="mb-3">
                                <label for="nomor_surat_tugas" class="form-label">Nomor Surat Tugas *</label>
                                <input type="text" class="form-control" id="nomor_surat_tugas" name="nomor_surat_tugas" required>
                            </div>

                            <div class="mb-3">
                                <label for="tanggal_surat_tugas" class="form-label">Tanggal Surat Tugas *</label>
                                <input type="date" class="form-control" id="tanggal_surat_tugas" name="tanggal_surat_tugas" required>
                            </div>

                            <div class="mb-3">
                                <label for="nomor_rekomtek" class="form-label">Nomor Rekomtek *</label>
                                <input type="text" class="form-control" id="nomor_rekomtek" name="nomor_rekomtek" required>
                            </div>

                            <div class="mb-3">
                                <label for="tanggal_rekomtek" class="form-label">Tanggal Rekomtek *</label>
                                <input type="date" class="form-control" id="tanggal_rekomtek" name="tanggal_rekomtek" required>
                            </div>
                        </div>
                    </div>

                    <hr>

                    <div class="row">
                        <!-- Informasi Opsional -->
                        <div class="col-md-6">
                            <h6 class="text-secondary mb-3"><i class="fas fa-info-circle"></i> Informasi Tambahan (Opsional)</h6>
                            
                            <div class="mb-3">
                                <label for="nomor_kbli" class="form-label">Nomor KBLI</label>
                                <input type="text" class="form-control" id="nomor_kbli" name="nomor_kbli" placeholder="Kosongkan jika belum ada">
                            </div>

                            <div class="mb-3">
                                <label for="nomor_gmp" class="form-label">Nomor GMP</label>
                                <input type="text" class="form-control" id="nomor_gmp" name="nomor_gmp" placeholder="Kosongkan jika belum ada">
                            </div>

                            <div class="mb-3">
                                <label for="tanggal_terbit_gmp" class="form-label">Tanggal Terbit GMP</label>
                                <input type="date" class="form-control" id="tanggal_terbit_gmp" name="tanggal_terbit_gmp">
                            </div>

                            <div class="mb-3">
                                <label for="masa_berlaku_gmp" class="form-label">Masa Berlaku GMP</label>
                                <input type="date" class="form-control" id="masa_berlaku_gmp" name="masa_berlaku_gmp">
                            </div>

                            <div class="mb-3">
                                <label for="peringkat_gmp" class="form-label">Peringkat GMP</label>
                                <select class="form-control" id="peringkat_gmp" name="peringkat_gmp">
                                    <option value="">-- Pilih Peringkat --</option>
                                    <option value="A">A</option>
                                    <option value="B">B</option>
                                    <option value="C">C</option>
                                </select>
                            </div>
                        </div>

                        <!-- Informasi Kunjungan -->
                        <div class="col-md-6">
                            <h6 class="text-primary mb-3"><i class="fas fa-users"></i> Informasi Kunjungan</h6>
                            
                            <div class="mb-3">
                                <label for="anggota_kunjungan" class="form-label">Anggota Kunjungan *</label>
                                <textarea class="form-control" id="anggota_kunjungan" name="anggota_kunjungan" rows="3" required placeholder="Nama-nama anggota tim kunjungan..."></textarea>
                            </div>

                            <div class="mb-3">
                                <label for="tanggal_kunjungan" class="form-label">Tanggal Kunjungan *</label>
                                <input type="date" class="form-control" id="tanggal_kunjungan" name="tanggal_kunjungan" required>
                            </div>
                        </div>
                    </div>

                    <hr>

                    <div class="d-flex justify-content-between">
                        <a href="{{ url_for('dashboard') }}" class="btn btn-secondary">
                            <i class="fas fa-times"></i> Batal
                        </a>
                        <button type="submit" class="btn btn-custom btn-lg">
                            <i class="fas fa-save"></i> Simpan Data
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<script>
// Auto-fill jenis_produk from dropdown or custom input
document.getElementById('jenis_produk').addEventListener('change', function() {
    if (this.value) {
        document.getElementById('jenis_produk_custom').value = '';
    }
});

document.getElementById('jenis_produk_custom').addEventListener('input', function() {
    if (this.value) {
        document.getElementById('jenis_produk').value = '';
    }
});

// Form submission handling
document.querySelector('form').addEventListener('submit', function(e) {
    const dropdown = document.getElementById('jenis_produk').value;
    const custom = document.getElementById('jenis_produk_custom').value;
    
    if (!dropdown && !custom) {
        e.preventDefault();
        alert('Silakan pilih atau tulis jenis produk!');
        return;
    }
    
    // Use custom input if filled, otherwise use dropdown
    if (custom) {
        document.getElementById('jenis_produk').value = custom;
    }
});
</script>
{% endblock %}
